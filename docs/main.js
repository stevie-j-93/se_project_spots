!function(){"use strict";var e={858:function(e,t,o){e.exports=o.p+"40608da7369d39bc1077.svg"},989:function(e,t,o){e.exports=o.p+"dba18798529f242c4c6d.svg"},263:function(e,t,o){e.exports=o.p+"1c517008152856bd3203.svg"},221:function(e,t,o){e.exports=o.p+"ed97f283921920196e5e.svg"},483:function(e,t,o){e.exports=o.p+"2fc47fd8e9a9bcd9612f.jpg"},619:function(e,t,o){e.exports=o.p+"d38272e02bb4f1ab1c37.svg"}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,o),c.exports}o.p="",function(){const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error__visible"},t=(e,t,o)=>{const r=`#${t.id}-error`,n=e.querySelector(r);n&&(n.textContent="",t.classList.remove(o.inputErrorClass),o.errorClass&&n.classList.remove(o.errorClass))},r=(e,t,o)=>{(e=>e.some(e=>!e.validity.valid))(e)?((e,t)=>{e&&(e.disabled=!0,e.classList.add(t.inactiveButtonClass))})(t,o):((e,t)=>{e&&(e.disabled=!1,e.classList.remove(t.inactiveButtonClass))})(t,o)},n=e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach(o=>{((e,o)=>{const n=Array.from(e.querySelectorAll(o.inputSelector)),c=e.querySelector(o.submitButtonSelector);r(n,c,o),n.forEach(s=>{s.addEventListener("input",function(){((e,o,r)=>{o.validity.valid?t(e,o,r):((e,t,o,r)=>{const n=`#${t.id}-error`,c=e.querySelector(n);t.classList.add(r.inputErrorClass),c&&(c.textContent=o,t.classList.add(r.inputErrorClass))})(e,o,o.validationMessage,r)})(e,s,o),r(n,c,o)})})})(o,e)})};function c(e,o,n,c){o.forEach(o=>{t(e,o,c)}),r(o,n,c)}n(e);const s=o(221),a=o(483),l=o(619),i=o(858),u=o(989),d=o(263);document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".header__logo");e&&(e.src=s);const t=document.querySelector(".profile__avatar");t&&(t.src=a);const o=document.querySelector(".profile__edit-btn img");o&&(o.src=l);const r=document.querySelector(".profile__new-post-btn img");r&&(r.src=i),document.querySelectorAll(".modal__close-btn img.close-btn").forEach(e=>{e.src=u});const n=document.querySelector("#preview-modal .modal__close-btn img");n&&(n.src=d)});const m=document.querySelector(".profile__edit-btn"),p=document.querySelector("#edit-profile-modal"),f=p.querySelector(".modal__close-btn"),_=document.forms["edit-profile-form"],y=p.querySelector("#profile-name-input"),v=p.querySelector("#profile-description-input"),S=document.querySelector(".profile__new-post-btn"),b=document.querySelector("#new-post-modal"),q=b.querySelector(".modal__close-btn"),g=b.querySelector(".modal__submit-btn"),w=b.querySelector(".modal__form"),h=b.querySelector("#card-caption-input"),E=b.querySelector("#card-image-input"),x=document.querySelector("#preview-modal"),L=x.querySelector(".modal__image"),k=x.querySelector(".modal__caption"),C=x.querySelector(".modal__close-btn"),A=document.querySelector("#card-template"),z=document.querySelector(".cards__list");function B(e){const t=A.content.querySelector(".card").cloneNode(!0),o=t.querySelector(".card__title"),r=t.querySelector(".card__image");r.src=e.link,r.alt=e.name,o.textContent=e.name;const n=t.querySelector(".card__like-btn");return n.addEventListener("click",()=>{n.classList.toggle("card__like-btn_active")}),t.querySelector(".card__delete-btn").addEventListener("click",()=>{t.remove()}),r.addEventListener("click",()=>{L.src=e.link,L.alt=e.name,k.textContent=e.name,T(x)}),t}document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("mousedown",t=>{t.target===e&&$(e)})}),C.addEventListener("click",()=>{$(x)});const j=document.querySelector(".profile__name"),D=document.querySelector(".profile__description");m.addEventListener("click",()=>{y.value=j.textContent.trim(),v.value=D.textContent.trim();const t=p.querySelector(".modal__form");if(T(p),!t)return void console.warn("Edit Profile form not found inside modal.");const o=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);c(t,o,r,e)}),f.addEventListener("click",function(){$(p)}),S.addEventListener("click",function(){const t=w,o=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);c(t,o,r,e),T(b)}),q.addEventListener("click",function(){$(b)}),_.addEventListener("submit",function(e){e.preventDefault(),j.textContent=y.value,D.textContent=v.value,$(p)}),w.addEventListener("submit",function(t){t.preventDefault();const o=B({name:h.value,link:E.value});z.prepend(o),t.target.reset(),disableButton(g,e),$(b)});let M=!1;function G(e){if("Escape"===e.key||"Esc"===e.key){const e=document.querySelector(".modal_is-opened");e&&$(e)}}function T(e){e.classList.add("modal_is-opened"),M||(document.addEventListener("keydown",G),M=!0)}function $(e){e.classList.remove("modal_is-opened"),!document.querySelector(".modal_is-opened")&&M&&(document.removeEventListener("keydown",G),M=!1)}[{name:"Golden Gate Bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"},{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"}].forEach(function(e){const t=B(e);z.append(t)}),n(e)}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU8sb0JBRWxCZ0IsU0FBU25CLGNBQWMscUJBQXVCNEYsSUFDakR6RSxTQUFTNkUsb0JBQW9CLFVBQVdILEdBQ3hDRCxHQUFzQixFQUUxQixDQTdMcUIsQ0FDbkIsQ0FDRWxCLEtBQU0scUJBQ05GLEtBQU0sOEhBRVIsQ0FDRUUsS0FBTSxjQUNORixLQUFNLDJIQUVSLENBQ0VFLEtBQU0scUJBQ05GLEtBQU0sbUhBRVIsQ0FDRUUsS0FBTSxrQkFDTkYsS0FBTSx5SEFFUixDQUNFRSxLQUFNLDREQUNORixLQUFNLDJIQUVSLENBQ0VFLEtBQU0sNEJBQ05GLEtBQU0sMEhBRVIsQ0FDRUUsS0FBTSxpQkFDTkYsS0FBTSw0SEFvS0duRCxRQUFRLFNBQVU0RSxHQUM3QixNQUFNOUIsRUFBY0YsRUFBZWdDLEdBQ25DakMsRUFBVWtDLE9BQU8vQixFQUNuQixHQUVBbkQsRUFBaUI5QixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy0xL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMtMS93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLTEvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMtMS8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl9fdmlzaWJsZVwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnSWQgPSBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgO1xuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoZXJyb3JNc2dJZCk7XG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgaWYgKCFlcnJvck1zZ0VsKSByZXR1cm47XG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dJZCA9IGAjJHtpbnB1dEVsLmlkfS1lcnJvcmA7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihlcnJvck1zZ0lkKTtcbiAgaWYgKCFlcnJvck1zZ0VsKSByZXR1cm47XG5cbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcblxuICBpZiAoY29uZmlnLmVycm9yQ2xhc3MpIHtcbiAgICBlcnJvck1zZ0VsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmVycm9yQ2xhc3MpO1xuICB9XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5jb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsLCBjb25maWcpID0+IHtcbiAgaWYgKCFidXR0b25FbCkgcmV0dXJuO1xuICBidXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XG4gIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufTtcblxuY29uc3QgZW5hYmxlQnV0dG9uID0gKGJ1dHRvbkVsLCBjb25maWcpID0+IHtcbiAgaWYgKCFidXR0b25FbCkgcmV0dXJuO1xuICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xuICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGVuYWJsZUJ1dHRvbihidXR0b25FbCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRWYWxpZGF0aW9uKGZvcm1FbCwgaW5wdXRMaXN0LCBidG5FbCwgY29uZmlnKSB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuICB9KTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ0bkVsLCBjb25maWcpO1xufVxuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5jb25zdCBsb2dvID0gcmVxdWlyZShcIi4uL2ltYWdlcy9TcG90cy5zdmdcIik7XG5jb25zdCBhdmF0YXIgPSByZXF1aXJlKFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIik7XG5jb25zdCBwZW5jaWwgPSByZXF1aXJlKFwiLi4vaW1hZ2VzL3BlbmNpbC5zdmdcIik7XG5jb25zdCBwbHVzID0gcmVxdWlyZShcIi4uL2ltYWdlcy9Hcm91cDI2LnN2Z1wiKTtcbmNvbnN0IGNsb3NlWCA9IHJlcXVpcmUoXCIuLi9pbWFnZXMvR3JvdXAyNy5zdmdcIik7XG5jb25zdCBwcmV2aWV3Q2xvc2UgPSByZXF1aXJlKFwiLi4vaW1hZ2VzL01vZGFscHJldmlldy1jbG9zZS5zdmdcIik7XG5cbi8vIC0tLSBhc3NpZ24gVVJMcyBhZnRlciBET00gaXMgcmVhZHkgLS0tXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gIGNvbnN0IGhlYWRlckxvZ28gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlcl9fbG9nb1wiKTtcbiAgaWYgKGhlYWRlckxvZ28pIGhlYWRlckxvZ28uc3JjID0gbG9nbztcblxuICBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG4gIGlmIChwcm9maWxlQXZhdGFyKSBwcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhcjtcblxuICBjb25zdCBlZGl0QnRuSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0biBpbWdcIik7XG4gIGlmIChlZGl0QnRuSW1nKSBlZGl0QnRuSW1nLnNyYyA9IHBlbmNpbDtcblxuICBjb25zdCBuZXdQb3N0QnRuSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uZXctcG9zdC1idG4gaW1nXCIpO1xuICBpZiAobmV3UG9zdEJ0bkltZykgbmV3UG9zdEJ0bkltZy5zcmMgPSBwbHVzO1xuXG4gIC8vIGFsbCBtb2RhbCBjbG9zZSBidXR0b25zIHRoYXQgdXNlIHRoZSBcImNsb3NlLWJ0blwiIGNsYXNzXG4gIGRvY3VtZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ0biBpbWcuY2xvc2UtYnRuXCIpXG4gICAgLmZvckVhY2goKGltZykgPT4ge1xuICAgICAgaW1nLnNyYyA9IGNsb3NlWDtcbiAgICB9KTtcblxuICAvLyBwcmV2aWV3IG1vZGFsIGNsb3NlICh1cGRhdGUgc2VsZWN0b3IgaWYgeW91cnMgZGlmZmVycylcbiAgY29uc3QgcHJldmlld0Nsb3NlSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBcIiNwcmV2aWV3LW1vZGFsIC5tb2RhbF9fY2xvc2UtYnRuIGltZ1wiXG4gICk7XG4gIGlmIChwcmV2aWV3Q2xvc2VJbWcpIHByZXZpZXdDbG9zZUltZy5zcmMgPSBwcmV2aWV3Q2xvc2U7XG59KTtcbmltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHNldHRpbmdzLFxuICByZXNldFZhbGlkYXRpb24sXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcblxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbCBUaG9yZW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5dO1xuXG5jb25zdCBlZGl0UHJvZmlsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnRuID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdO1xuY29uc3QgZWRpdFByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5cbmNvbnN0IG5ld1Bvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25ldy1wb3N0LWJ0blwiKTtcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XG5jb25zdCBuZXdQb3N0Q2xvc2VCdG4gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgY2FyZFN1Ym1pdEJ0biA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuY29uc3QgYWRkQ2FyZEZvcm1FbGVtZW50ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBuYW1lSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWNhcHRpb24taW5wdXRcIik7XG5jb25zdCBsaW5rSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWltYWdlLWlucHV0XCIpO1xuXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3SW1hZ2UgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3Q2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuY29uc3QgcHJldmlld0Nsb3NlQnRuID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcblxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKS5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG4gICAgaWYgKGUudGFyZ2V0ID09PSBtb2RhbCkgY2xvc2VNb2RhbChtb2RhbCk7XG4gIH0pO1xufSk7XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBjYXJkVGl0bGVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG5cbiAgY29uc3QgY2FyZExpa2VCdG5FbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNhcmRMaWtlQnRuRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjYXJkTGlrZUJ0bkVsLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XG4gIH0pO1xuXG4gIGNvbnN0IGNhcmREZWxldGVCdG5FbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcbiAgY2FyZERlbGV0ZUJ0bkVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH0pO1xuXG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbnByZXZpZXdDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XG59KTtcblxuY29uc3QgcHJvZmlsZU5hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuZWRpdFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdFByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50LnRyaW0oKTtcbiAgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQudHJpbSgpO1xuXG4gIGNvbnN0IGZvcm1FbCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgb3Blbk1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xuXG4gIGlmICghZm9ybUVsKSB7XG4gICAgY29uc29sZS53YXJuKFwiRWRpdCBQcm9maWxlIGZvcm0gbm90IGZvdW5kIGluc2lkZSBtb2RhbC5cIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IGJ0bkVsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3Ioc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICBpZiAodHlwZW9mIHJlc2V0VmFsaWRhdGlvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgcmVzZXRWYWxpZGF0aW9uKGZvcm1FbCwgaW5wdXRMaXN0LCBidG5FbCwgc2V0dGluZ3MpO1xuICB9IGVsc2Uge1xuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnRuRWwsIHNldHRpbmdzKTtcbiAgfVxufSk7XG5cbmVkaXRQcm9maWxlQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn0pO1xuXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGZvcm1FbCA9IGFkZENhcmRGb3JtRWxlbWVudDtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IGJ0bkVsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3Ioc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHJlc2V0VmFsaWRhdGlvbihmb3JtRWwsIGlucHV0TGlzdCwgYnRuRWwsIHNldHRpbmdzKTtcbiAgb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCk7XG59KTtcblxubmV3UG9zdENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQgPSBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59XG5cbmVkaXRQcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KTtcblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGlucHV0VmFsdWVzID0ge1xuICAgIG5hbWU6IG5hbWVJbnB1dC52YWx1ZSxcbiAgICBsaW5rOiBsaW5rSW5wdXQudmFsdWUsXG4gIH07XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaW5wdXRWYWx1ZXMpO1xuICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG4gIGV2dC50YXJnZXQucmVzZXQoKTtcbiAgZGlzYWJsZUJ1dHRvbihjYXJkU3VibWl0QnRuLCBzZXR0aW5ncyk7XG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbn1cblxuYWRkQ2FyZEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbmxldCBlc2NMaXN0ZW5lckF0dGFjaGVkID0gZmFsc2U7XG5cbmZ1bmN0aW9uIG9uRXNjS2V5ZG93bihlKSB7XG4gIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIiB8fCBlLmtleSA9PT0gXCJFc2NcIikge1xuICAgIGNvbnN0IG9wZW5lZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpO1xuICAgIGlmIChvcGVuZWQpIGNsb3NlTW9kYWwob3BlbmVkKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcblxuICBpZiAoIWVzY0xpc3RlbmVyQXR0YWNoZWQpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBvbkVzY0tleWRvd24pO1xuICAgIGVzY0xpc3RlbmVyQXR0YWNoZWQgPSB0cnVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX2lzLW9wZW5lZFwiKTtcblxuICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpICYmIGVzY0xpc3RlbmVyQXR0YWNoZWQpIHtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBvbkVzY0tleWRvd24pO1xuICAgIGVzY0xpc3RlbmVyQXR0YWNoZWQgPSBmYWxzZTtcbiAgfVxufVxuXG5pbml0aWFsQ2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcbn0pO1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInAiLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwiY29uZmlnIiwiZXJyb3JNc2dJZCIsImlkIiwiZXJyb3JNc2dFbCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWwiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlQnV0dG9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsImJ1dHRvbkVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwicmVzZXRWYWxpZGF0aW9uIiwiYnRuRWwiLCJsb2dvIiwicmVxdWlyZSIsImF2YXRhciIsInBlbmNpbCIsInBsdXMiLCJjbG9zZVgiLCJwcmV2aWV3Q2xvc2UiLCJoZWFkZXJMb2dvIiwic3JjIiwicHJvZmlsZUF2YXRhciIsImVkaXRCdG5JbWciLCJuZXdQb3N0QnRuSW1nIiwiaW1nIiwicHJldmlld0Nsb3NlSW1nIiwiZWRpdFByb2ZpbGVCdG4iLCJlZGl0UHJvZmlsZU1vZGFsIiwiZWRpdFByb2ZpbGVDbG9zZUJ0biIsImVkaXRQcm9maWxlRm9ybSIsImZvcm1zIiwiZWRpdFByb2ZpbGVOYW1lSW5wdXQiLCJlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJuZXdQb3N0QnRuIiwibmV3UG9zdE1vZGFsIiwibmV3UG9zdENsb3NlQnRuIiwiY2FyZFN1Ym1pdEJ0biIsImFkZENhcmRGb3JtRWxlbWVudCIsIm5hbWVJbnB1dCIsImxpbmtJbnB1dCIsInByZXZpZXdNb2RhbCIsInByZXZpZXdJbWFnZSIsInByZXZpZXdDYXB0aW9uIiwicHJldmlld0Nsb3NlQnRuIiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0IiwiZ2V0Q2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlRWwiLCJjYXJkSW1hZ2VFbCIsImxpbmsiLCJhbHQiLCJuYW1lIiwiY2FyZExpa2VCdG5FbCIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiZSIsInRhcmdldCIsImNsb3NlTW9kYWwiLCJwcm9maWxlTmFtZUVsIiwicHJvZmlsZURlc2NyaXB0aW9uRWwiLCJ2YWx1ZSIsInRyaW0iLCJjb25zb2xlIiwid2FybiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwicHJlcGVuZCIsInJlc2V0IiwiZXNjTGlzdGVuZXJBdHRhY2hlZCIsIm9uRXNjS2V5ZG93biIsImtleSIsIm9wZW5lZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJpdGVtIiwiYXBwZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==