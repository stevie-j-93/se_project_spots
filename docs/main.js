!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error__visible"},t=(e,t,o)=>{const r=`#${t.id}-error`,n=e.querySelector(r);n&&(n.textContent="",t.classList.remove(o.inputErrorClass),o.errorClass&&n.classList.remove(o.errorClass))},o=(e,t,o)=>{(e=>e.some(e=>!e.validity.valid))(e)?((e,t)=>{e&&(e.disabled=!0,e.classList.add(t.inactiveButtonClass))})(t,o):((e,t)=>{e&&(e.disabled=!1,e.classList.remove(t.inactiveButtonClass))})(t,o)},r=e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach(r=>{((e,r)=>{const n=Array.from(e.querySelectorAll(r.inputSelector)),s=e.querySelector(r.submitButtonSelector);o(n,s,r),n.forEach(c=>{c.addEventListener("input",function(){((e,o,r)=>{o.validity.valid?t(e,o,r):((e,t,o,r)=>{const n=`#${t.id}-error`,s=e.querySelector(n);t.classList.add(r.inputErrorClass),s&&(s.textContent=o,t.classList.add(r.inputErrorClass))})(e,o,o.validationMessage,r)})(e,c,r),o(n,s,r)})})})(r,e)})};function n(e,r,n,s){r.forEach(o=>{t(e,o,s)}),o(r,n,s)}r(e);const s=document.querySelector(".profile__edit-btn"),c=document.querySelector("#edit-profile-modal"),a=c.querySelector(".modal__close-btn"),l=document.forms["edit-profile-form"],i=c.querySelector("#profile-name-input"),u=c.querySelector("#profile-description-input"),d=document.querySelector(".profile__new-post-btn"),m=document.querySelector("#new-post-modal"),p=m.querySelector(".modal__close-btn"),f=m.querySelector(".modal__submit-btn"),y=m.querySelector(".modal__form"),_=m.querySelector("#card-caption-input"),S=m.querySelector("#card-image-input"),v=document.querySelector("#preview-modal"),q=v.querySelector(".modal__image"),b=v.querySelector(".modal__caption"),g=v.querySelector(".modal__close-btn"),w=document.querySelector("#card-template"),h=document.querySelector(".cards__list");function E(e){const t=w.content.querySelector(".card").cloneNode(!0),o=t.querySelector(".card__title"),r=t.querySelector(".card__image");r.src=e.link,r.alt=e.name,o.textContent=e.name;const n=t.querySelector(".card__like-btn");return n.addEventListener("click",()=>{n.classList.toggle("card__like-btn_active")}),t.querySelector(".card__delete-btn").addEventListener("click",()=>{t.remove()}),r.addEventListener("click",()=>{q.src=e.link,q.alt=e.name,b.textContent=e.name,A(v)}),t}document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("mousedown",t=>{t.target===e&&z(e)})}),g.addEventListener("click",()=>{z(v)});const k=document.querySelector(".profile__name"),L=document.querySelector(".profile__description");s.addEventListener("click",()=>{i.value=k.textContent.trim(),u.value=L.textContent.trim();const t=c.querySelector(".modal__form");if(A(c),!t)return void console.warn("Edit Profile form not found inside modal.");const o=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);n(t,o,r,e)}),a.addEventListener("click",function(){z(c)}),d.addEventListener("click",function(){const t=y,o=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);n(t,o,r,e),A(m)}),p.addEventListener("click",function(){z(m)}),l.addEventListener("submit",function(e){e.preventDefault(),k.textContent=i.value,L.textContent=u.value,z(c)}),y.addEventListener("submit",function(t){t.preventDefault();const o=E({name:_.value,link:S.value});h.prepend(o),t.target.reset(),disableButton(f,e),z(m)});let C=!1;function x(e){if("Escape"===e.key||"Esc"===e.key){const e=document.querySelector(".modal_is-opened");e&&z(e)}}function A(e){e.classList.add("modal_is-opened"),C||(document.addEventListener("keydown",x),C=!0)}function z(e){e.classList.remove("modal_is-opened"),!document.querySelector(".modal_is-opened")&&C&&(document.removeEventListener("keydown",x),C=!1)}[{name:"Golden Gate Bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"},{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"}].forEach(function(e){const t=E(e);h.append(t)}),r(e)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVNuQixjQUFjLG9CQUNsQ2tGLEdBQVFkLEVBQVdjLEVBQ3pCLENBQ0YsQ0FFQSxTQUFTbEIsRUFBVUMsR0FDakJBLEVBQU0vRCxVQUFVWSxJQUFJLG1CQUVmaUUsSUFDSDVELFNBQVNLLGlCQUFpQixVQUFXd0QsR0FDckNELEdBQXNCLEVBRTFCLENBRUEsU0FBU1gsRUFBV0gsR0FDbEJBLEVBQU0vRCxVQUFVQyxPQUFPLG9CQUVsQmdCLFNBQVNuQixjQUFjLHFCQUF1QitFLElBQ2pENUQsU0FBU2dFLG9CQUFvQixVQUFXSCxHQUN4Q0QsR0FBc0IsRUFFMUIsQ0E3THFCLENBQ25CLENBQ0VsQixLQUFNLHFCQUNORixLQUFNLDhIQUVSLENBQ0VFLEtBQU0sY0FDTkYsS0FBTSwySEFFUixDQUNFRSxLQUFNLHFCQUNORixLQUFNLG1IQUVSLENBQ0VFLEtBQU0sa0JBQ05GLEtBQU0seUhBRVIsQ0FDRUUsS0FBTSw0REFDTkYsS0FBTSwySEFFUixDQUNFRSxLQUFNLDRCQUNORixLQUFNLDBIQUVSLENBQ0VFLEtBQU0saUJBQ05GLEtBQU0sNEhBb0tHdEMsUUFBUSxTQUFVK0QsR0FDN0IsTUFBTS9CLEVBQWNGLEVBQWVpQyxHQUNuQ2xDLEVBQVVtQyxPQUFPaEMsRUFDbkIsR0FFQXJDLEVBQWlCOUIsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMtMS8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy0xLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idG5fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX192aXNpYmxlXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dJZCA9IGAjJHtpbnB1dEVsLmlkfS1lcnJvcmA7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihlcnJvck1zZ0lkKTtcbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICBpZiAoIWVycm9yTXNnRWwpIHJldHVybjtcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0lkID0gYCMke2lucHV0RWwuaWR9LWVycm9yYDtcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGVycm9yTXNnSWQpO1xuICBpZiAoIWVycm9yTXNnRWwpIHJldHVybjtcblxuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuXG4gIGlmIChjb25maWcuZXJyb3JDbGFzcykge1xuICAgIGVycm9yTXNnRWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7XG4gIH1cbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcbiAgICByZXR1cm4gIWlucHV0LnZhbGlkaXR5LnZhbGlkO1xuICB9KTtcbn07XG5cbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xuICBpZiAoIWJ1dHRvbkVsKSByZXR1cm47XG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG59O1xuXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xuICBpZiAoIWJ1dHRvbkVsKSByZXR1cm47XG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XG4gIGJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKSA9PiB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWwsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgZW5hYmxlQnV0dG9uKGJ1dHRvbkVsLCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldFZhbGlkYXRpb24oZm9ybUVsLCBpbnB1dExpc3QsIGJ0bkVsLCBjb25maWcpIHtcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XG4gIH0pO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnRuRWwsIGNvbmZpZyk7XG59XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBzcG90cyBmcm9tIFwiLi4vaW1hZ2VzL1Nwb3RzLnN2Z1wiO1xuaW1wb3J0IGF2YXRhciBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcbmltcG9ydCBwZW5jaWwgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwuc3ZnXCI7XG5cbmltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHNldHRpbmdzLFxuICByZXNldFZhbGlkYXRpb24sXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcblxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbCBUaG9yZW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5dO1xuXG5jb25zdCBlZGl0UHJvZmlsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnRuID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdO1xuY29uc3QgZWRpdFByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5cbmNvbnN0IG5ld1Bvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25ldy1wb3N0LWJ0blwiKTtcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XG5jb25zdCBuZXdQb3N0Q2xvc2VCdG4gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgY2FyZFN1Ym1pdEJ0biA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuY29uc3QgYWRkQ2FyZEZvcm1FbGVtZW50ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBuYW1lSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWNhcHRpb24taW5wdXRcIik7XG5jb25zdCBsaW5rSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWltYWdlLWlucHV0XCIpO1xuXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3SW1hZ2UgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3Q2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuY29uc3QgcHJldmlld0Nsb3NlQnRuID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcblxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKS5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG4gICAgaWYgKGUudGFyZ2V0ID09PSBtb2RhbCkgY2xvc2VNb2RhbChtb2RhbCk7XG4gIH0pO1xufSk7XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBjYXJkVGl0bGVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG5cbiAgY29uc3QgY2FyZExpa2VCdG5FbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNhcmRMaWtlQnRuRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjYXJkTGlrZUJ0bkVsLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XG4gIH0pO1xuXG4gIGNvbnN0IGNhcmREZWxldGVCdG5FbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcbiAgY2FyZERlbGV0ZUJ0bkVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH0pO1xuXG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbnByZXZpZXdDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XG59KTtcblxuY29uc3QgcHJvZmlsZU5hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuZWRpdFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdFByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50LnRyaW0oKTtcbiAgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQudHJpbSgpO1xuXG4gIGNvbnN0IGZvcm1FbCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgb3Blbk1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xuXG4gIGlmICghZm9ybUVsKSB7XG4gICAgY29uc29sZS53YXJuKFwiRWRpdCBQcm9maWxlIGZvcm0gbm90IGZvdW5kIGluc2lkZSBtb2RhbC5cIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IGJ0bkVsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3Ioc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICBpZiAodHlwZW9mIHJlc2V0VmFsaWRhdGlvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgcmVzZXRWYWxpZGF0aW9uKGZvcm1FbCwgaW5wdXRMaXN0LCBidG5FbCwgc2V0dGluZ3MpO1xuICB9IGVsc2Uge1xuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnRuRWwsIHNldHRpbmdzKTtcbiAgfVxufSk7XG5cbmVkaXRQcm9maWxlQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn0pO1xuXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGZvcm1FbCA9IGFkZENhcmRGb3JtRWxlbWVudDtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IGJ0bkVsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3Ioc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHJlc2V0VmFsaWRhdGlvbihmb3JtRWwsIGlucHV0TGlzdCwgYnRuRWwsIHNldHRpbmdzKTtcbiAgb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCk7XG59KTtcblxubmV3UG9zdENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQgPSBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59XG5cbmVkaXRQcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KTtcblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGlucHV0VmFsdWVzID0ge1xuICAgIG5hbWU6IG5hbWVJbnB1dC52YWx1ZSxcbiAgICBsaW5rOiBsaW5rSW5wdXQudmFsdWUsXG4gIH07XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaW5wdXRWYWx1ZXMpO1xuICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG4gIGV2dC50YXJnZXQucmVzZXQoKTtcbiAgZGlzYWJsZUJ1dHRvbihjYXJkU3VibWl0QnRuLCBzZXR0aW5ncyk7XG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbn1cblxuYWRkQ2FyZEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbmxldCBlc2NMaXN0ZW5lckF0dGFjaGVkID0gZmFsc2U7XG5cbmZ1bmN0aW9uIG9uRXNjS2V5ZG93bihlKSB7XG4gIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIiB8fCBlLmtleSA9PT0gXCJFc2NcIikge1xuICAgIGNvbnN0IG9wZW5lZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpO1xuICAgIGlmIChvcGVuZWQpIGNsb3NlTW9kYWwob3BlbmVkKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcblxuICBpZiAoIWVzY0xpc3RlbmVyQXR0YWNoZWQpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBvbkVzY0tleWRvd24pO1xuICAgIGVzY0xpc3RlbmVyQXR0YWNoZWQgPSB0cnVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX2lzLW9wZW5lZFwiKTtcblxuICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpICYmIGVzY0xpc3RlbmVyQXR0YWNoZWQpIHtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBvbkVzY0tleWRvd24pO1xuICAgIGVzY0xpc3RlbmVyQXR0YWNoZWQgPSBmYWxzZTtcbiAgfVxufVxuXG5pbml0aWFsQ2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcbn0pO1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiJdLCJuYW1lcyI6WyJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwiY29uZmlnIiwiZXJyb3JNc2dJZCIsImlkIiwiZXJyb3JNc2dFbCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWwiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlQnV0dG9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsImJ1dHRvbkVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwicmVzZXRWYWxpZGF0aW9uIiwiYnRuRWwiLCJlZGl0UHJvZmlsZUJ0biIsImVkaXRQcm9maWxlTW9kYWwiLCJlZGl0UHJvZmlsZUNsb3NlQnRuIiwiZWRpdFByb2ZpbGVGb3JtIiwiZm9ybXMiLCJlZGl0UHJvZmlsZU5hbWVJbnB1dCIsImVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsIm5ld1Bvc3RCdG4iLCJuZXdQb3N0TW9kYWwiLCJuZXdQb3N0Q2xvc2VCdG4iLCJjYXJkU3VibWl0QnRuIiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwibmFtZUlucHV0IiwibGlua0lucHV0IiwicHJldmlld01vZGFsIiwicHJldmlld0ltYWdlIiwicHJldmlld0NhcHRpb24iLCJwcmV2aWV3Q2xvc2VCdG4iLCJjYXJkVGVtcGxhdGUiLCJjYXJkc0xpc3QiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkVGl0bGVFbCIsImNhcmRJbWFnZUVsIiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJjYXJkTGlrZUJ0bkVsIiwidG9nZ2xlIiwib3Blbk1vZGFsIiwibW9kYWwiLCJlIiwidGFyZ2V0IiwiY2xvc2VNb2RhbCIsInByb2ZpbGVOYW1lRWwiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsInZhbHVlIiwidHJpbSIsImNvbnNvbGUiLCJ3YXJuIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJwcmVwZW5kIiwicmVzZXQiLCJlc2NMaXN0ZW5lckF0dGFjaGVkIiwib25Fc2NLZXlkb3duIiwia2V5Iiwib3BlbmVkIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIml0ZW0iLCJhcHBlbmQiXSwic291cmNlUm9vdCI6IiJ9